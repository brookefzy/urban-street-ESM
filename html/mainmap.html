<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8' />
    <title></title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />

    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v1.10.0/mapbox-gl.js'></script>
    <script src="../javascript/maphelpers.js"></script>

    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v1.10.0/mapbox-gl.css' rel='stylesheet' />
    <link rel="stylesheet" href="../css/maps_main.css">
    <!-- geocoding style -->
        <link
    rel="stylesheet"
    href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.5.1/mapbox-gl-geocoder.css"
    type="text/css"
    />

    <style>

    </style>

  </head>

  <body>

    <div id='map' class='map pad2'></div>



 <!-- geocoding search and side bar -->


        <div class="as-container as-container--scrollable js-scroll">
            <section class="as-box" id="search-container">
                <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.5.1/mapbox-gl-geocoder.min.js"></script>


            </section>
            <section class="as-box" id="legend">
                <!-- legend -->
                <div class="legend legend-panel js-legend hide-in-onboarding">
                    <div class="widgets-item legend-inner as-box">
                        <h2 class="as-body as-font--medium legend-text" id="legendtitle">ESM</h2>
                        <div class="esm-legend" id="esm-color"></div>
                        <div class="labels-legend">
                            <span class="as-caption" id="legend-left">Segregated</span>
                            <span class="as-caption" id="legend-right">Mixed</span>
                            <!-- <div class="legend-triangle">
                                <svg height="10" width="100" class ="legend-triangle-poly">
                                    <polygon points="0,10,100,10,100,0,0,7" style="fill:white;stroke:no" />
                                </svg>
                                <span class="as-caption-2" >Total Time</span>
                            </div> -->

                        <!-- <div class="labels-legend"> -->
                        </div>
                    </div>
                </div>
            </section>
            <!-- <section  class="as-box layer" >
                <select id="layer" onchange = "switchStyle()">
                    <div class="dropdown-content">
                        <option value="mismatch">Mismatch Index</option>
                        <option value="offline">Offline Visit</option>
                        <option value="online">Online Visit</option>
                        <option value="quantilediff">Quantile Differences</option>
                    </div>
                </select>
            </section> -->
        </div>





  <!-- Promise polyfill script required to use Mapbox GL Geocoder in IE 11 -->
  <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/es6-promise@4/dist/es6-promise.auto.min.js"></script>

  <script>
    var hoveredstreetId = null;

    mapboxgl.accessToken = 'pk.eyJ1IjoiYnJvb2tlZnp5IiwiYSI6ImNqdWFtZHNmdTA0N3o0M21oZG9peDU2NXMifQ.fbFnwmA72jGPO8IHcfEeRA';

    var map = new mapboxgl.Map({
      container: 'map', // container id
      style: 'mapbox://styles/brookefzy/cl7ye6i8p00d414mmi42n55pl' // replace this with your style URL
    });

    
    
      map.on('click','str-boston-16', function(e) {
   
          new mapboxgl.Popup()
          .setLngLat(e.lngLat)
          .setHTML(
            '<h2><strong>'+e.features[0].properties.name+'</strong></h2>'+
                '<h5>STREET ESM</h5>'+
                '<h4><strong>'+
                    round2(e.features[0].properties.expdiv)+'</strong></h4>'+
                    '<h5>VISITING TIME BY INCOME GROUP</h5>'+
                    '<h3>'+ bar4group(e.features[0].properties['0pro'], e.features[0].properties['1pro'], 
                e.features[0].properties['2pro'],e.features[0].properties['3pro'])+
                '<h5>TOTAL VISITING HOURS: <strong>'+
            roundHour(e.features[0].properties.timevisit)+'</strong></h5>'
        )
          .addTo(map);
          });

         

          // Change the cursor to a pointer when the mouse is over the layer.
          map.on('mouseenter', 'str-boston-16', function() {
          map.getCanvas().style.cursor = 'pointer';
          });

          // Change it back to a pointer when it leaves.
          map.on('mouseleave', 'str-boston-16', function() {
          map.getCanvas().style.cursor = '';
          });

//geocoder
            map.addControl(
            new MapboxGeocoder({
            accessToken: mapboxgl.accessToken,
            mapboxgl: mapboxgl
            }));
//geocoder


  </script>



  </body>

</html>
